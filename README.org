#+title: Zrównoleglenie wstępnego przetwarzania danych przy użyciu OpenMPI
#+AUTHOR: Karol Wójcik, Krzysztof Swałdek
#+DATE: 2020-10-14, Wtorek

#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [12pt]
#+LATEX_HEADER: \usepackage[a4paper, inner=37.125mm, outer=33.4125mm, top=37.125mm, bottom=37.125mm, heightrounded, marginparwidth=51pt, marginparsep=17pt, headsep=24pt]{geometry}
#+EXCLUDE_TAGS: noexport
#+LATEX_HEADER: \usepackage{graphicx}
#+LaTeX_HEADER: \usepackage[T1]{fontenc}
#+LaTeX_HEADER: \usepackage{mathpazo}
#+LaTeX_HEADER: \linespread{1.05}
#+LATEX_HEADER: \usepackage{setspace}
#+LATEX_HEADER: \doublespacing
#+LATEX_HEADER: \usepackage[polish]{babel}
#+LATEX_HEADER: \usepackage{polski}
#+LATEX_HEADER: \usepackage{listings}
#+LaTeX_HEADER: \lstset{basicstyle=\small\ttfamily}
#+LaTeX_HEADER: \usepackage{alltt}
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LaTeX_HEADER: \usepackage{moreverb}
#+LATEX_HEADER: \usepackage{ragged2e}
#+LATEX_HEADER: \usepackage{xltxtra}
#+LaTeX_HEADER: \usepackage{pdfpages}
#+OPTIONS: ^:{}
#+LANGUAGE: pl
#+OPTIONS: toc:nil

#+begin_export latex
  \clearpage \tableofcontents \clearpage
#+end_export

* Wprowadzenie
  Celem projektu jest implementacja algorytmu "Eliminacji obserwacji odstających" do wstępnego przetwarzania danych, a także wykonanie i udokumentowanie pomiaru czasowago trzech wariantów programu. \\

  \noindent
  1. Zrównoleglenie programu za pomocą OpenMPI
  2. Zrównoleglenie programu za pomocą OpenOMP
  3. Zrównoleglenie programu w modelu hybrydowym; połączenie OpenMPI i OpenOMP
* Opis badanego algorytmu
Algorytm "eliminacji obserwacji odstających" korzysta z reguły trzech sigm, która stanowi:

#+BEGIN_QUOTE
Dla zmiennej, która ma rozkład normalny bądź zbliżony do rozkładu normalnego można wyznaczyć ile obserwacji znajduje się w pewnym zakresie mierzonym odchyleniem standardowym (od średniej).

Można zaobserwować, że:
- 68,2% obserwacji znajduje się w zakresie pomiędzy +/- 1 odchylenie standardowe od średniej
- 95,4% obserwacji znajduje się w zakresie pomiędzy +/- 2 odchylenia standardowe od średniej
- 99,7% obserwacji znajduje się w zakresie pomiędzy +/- 3 odchylenia standardowe od średniej
- 99,994% obserwacji znajduje się w zakresie pomiędzy +/- 4 odchylenia standardowe od średniej
#+END_QUOTE

\noindent
Zważywszy na powyższe w projekcie przyjęliśmy za wartości odstające wszystkie te, które odbiegają od średniej o +/- 3 odchylenia standardowe. Wartości odstające nie są usuwane ze zbioru, by nie powodować dziur. Za wartości odstające przyjęliśmy wartość średnią ze zbioru.

Operacje odpowiadające za eliminację i podmianę wartości na średnią prezentują się następująco:

#+BEGIN_SRC c++ :eval no
for (auto x : xv) {
  double zscore = (x - mean_t) / std_t;

  if (zscore < 3) {
    nxv_private.push_back(x);
  } else {
    nxv_private.push_back(mean_t);
  }
}
#+END_SRC

* Metoda wykonywania pomiaru
Program dla każdego wariantu został uruchomiony trzydzieści razy na platformie uczelnianej do obliczeń rozproszonych w celu zapewnienia poprawności i statystycznej dokładności wykonywach pomiarów. Pomiary czasowe podawane są dla każdego wariantu w jednoste ~ms~ (milisekundy)
* Opis zbióru danych
  \noindent
  Dane pochodzą z archiwum [[https://archive.ics.uci.edu/ml/datasets/Skin+Segmentation][uci]]. Zawierają próbki kolorów G, R, B z wycinków obrazków twarzy ludzi w tym:
  - starych
  - młodych
  - w średnim wieku
  - o różnej rasie i kolorze skóry

  \noindent
  Sumaryczna liczba próbek wynosi 14 799 994. Rozmiar pliku wynosi 191MB. W danych istnieją też wycinki z różnych obrazków nie przedstawiających ludzi. \\

  \noindent
  Oryginalnie kolumna ostatnia zawierająca informację o przynależności kolorów G, R, B do twarzy miała następującą postać: \\

  \noindent
  *SKIN*:
  - ~1~ - twarz
  - ~2~ - nie twarz

  \noindent
  Dane zostały poddane wstępnej obróbce:
  1. Zamieniono kolumny tak, by odpowiadała kolejność R, G, B
  2. Zamieniono oznaczenie *SKIN* na:
     - ~0~ - nie twarz
     - ~1~ - twarz
* Pomiary
1. Zrównoleglenie programu za pomocą OpenMPI
   Opis dla Gathera i same wyniki dla mpi

2. Zrównoleglenie programu za pomocą OpenOMP

3. Zrównoleglenie programu w modelu hybrydowym; połączenie OpenMPI i OpenOMP

*Dla wszystkich pomiarów wykresy prezentują się następująco:*
#+CAPTION: Pomiar dla wszystkich wariantów z skalą logatytmiczną
[[./resources/all.png]]

#+CAPTION: Pomiar dla wszystkich wariantów
[[./resources/all1.png]]


* Podsumowanie
